{% extends "base.html" %}
{% block body_block %}
  <h1>{{ caps_detail.production.name }} (LotNr: {{ caps_detail.production.lot_nr }})</h1>
  <p>{{ caps_detail.calc_date }}</p>
  <div class="container">
    <div class="row">
      <div class="col">
        <table class="table">
          <thead class="thead-dark">
            <tr>
              <th scope="col">Input data</th>
              <th scope="col">Value</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th scope="row">Mass of 1 empty capsule [mg]</th>
              <td>{{ caps_detail.mass_1_caps_empty }}</td>
            </tr>
            <tr>
              <th scope="row">Mass of 20 filled capsules [mg]</th>
              <td>{{ caps_detail.mass_20_caps_full }}</td>
            </tr>
            <tr>
              <th scope="row">Mass of heaviest capsule [mg]</th>
              <td>{{ caps_detail.mass_max1 }}</td>
            </tr>
            <tr>
              <th scope="row">Mass of second heaviest capsule [mg]</th>
              <td>{{ caps_detail.mass_max2 }}</td>
            </tr>
            <tr>
              <th scope="row">Mass of third heaviest capsule [mg]</th>
              <td>{{ caps_detail.mass_max3 }}</td>
            </tr>
            <tr>
              <th scope="row">Mass of lightest capsule [mg]</th>
              <td>{{ caps_detail.mass_min1 }}</td>
            </tr>
            <tr>
              <th scope="row">Mass of second lightest capsule [mg]</th>
              <td>{{ caps_detail.mass_min2 }}</td>
            </tr>
            <tr>
              <th scope="row">Mass of third lightest capsule [mg]</th>
              <td>{{ caps_detail.mass_min3 }}</td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="col">
        <table class="table">
          <thead class="thead-dark">
            <tr>
              <th scope="col">Calculated data</th>
              <th scope="col">Value</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th scope="row"> + {{ caps_detail.diff_x2 }} % </th>
              <td> {{ caps_detail.plus_2_diff }} </td>
            </tr>
            <tr>
              <th scope="row"> + {{ caps_detail.diff }} % </th>
              <td> {{ caps_detail.plus_1_diff }} </td>
            </tr>
            <tr>
              <th scope="row">Mean content</th>
              <td> {{ caps_detail.mean }} </td>
            </tr>
            <tr>
              <th scope="row"> - {{ caps_detail.diff }} % </th>
              <td> {{ caps_detail.minus_1_diff }} </td>
            </tr>
            <tr>
              <th scope="row"> - {{ caps_detail.diff_x2 }} % </th>
              <td> {{ caps_detail.minus_2_diff }} </td>
            </tr>
            <tr>
              <th scope="row"> # of caps over +/- {{ caps_detail.diff_x2 }} %:</th>
              <td> {{ caps_detail.counter_above_2_diff }} </td>
            </tr>
            <tr>
              <th scope="row"> # of caps over +/- {{ caps_detail.diff }} %:</th>
              <td> {{ caps_detail.counter_above_1_diff }} </td>
            </tr>
            <tr>
              <th scope="row">TEST RESULT:</th>
              {% if caps_detail.release_note %} <td style="color:green;">PASSED</td>{% else %}<td style="color:red;">FAILED</td>{% endif %}
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    {% if caps_detail.uniformity_plot %}
      <img class="img-fluid" src="data:image/png;base64, {{caps_detail.uniformity_plot|safe}}">
    {% endif %}
  <p>
    <a class="btn btn-warning" href="{% url 'capsules:update' pk=caps_detail.pk %}">Edit</a>
    <a class="btn btn-danger" href="{% url 'capsules:delete' pk=caps_detail.pk %}">Delete</a>
    <a class="btn btn-primary" href="{% url 'capsules:pdf' pk=caps_detail.pk %}">Generate PDF</a>
    <!-- <a class="btn btn-primary" href="{% url 'capsules:pdf' pk=caps_detail.pk %}">Generate PDF</a> -->
  </p>
{% endblock %}
